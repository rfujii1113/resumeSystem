<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Resume Form</title>
    <link rel="stylesheet" th:href="@{/css/resumeForm.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="/js/resumeForm.js" defer></script>
</head>

<body>
    <div class="container a4-container">
        <div class="header">
            <!-- キャンセルボタンを左側に追加 -->
            <a th:href="@{/resume/view(userId=${resumeDto.userInfo.userId})}" class="cancel-button"
                onclick="return confirm('変更を保存せずに戻りますか？');">戻る</a>
            <!-- 保存ボタン -->
            <button type="submit" form="resume-form" class="save-button">保存</button>
        </div>

        <form id="resume-form" th:action="@{/resume/save}" th:object="${resumeDto}" method="post">
            <!-- ユーザーIDを送信するためのhidden input -->
            <input type="hidden" th:field="*{userInfo.userId}" />

            <!-- Personal Information Section -->
            <section class="personal-info">
                <h2>個人情報</h2>
                <div class="input-group">
                    <label>
                        名前(漢字)
                        <input type="text" th:field="*{userInfo.userName}" placeholder="" required>
                    </label>
                    <label>
                        名前(ローマ字)
                        <input type="text" th:field="*{userInfo.userNameRomaji}" placeholder="" required>
                    </label>
                    <label>
                        性別
                        <select th:field="*{userInfo.gender}" required>
                            <option value="false">男性</option>
                            <option value="true">女性</option>
                        </select>
                    </label>
                    <label>
                        生年月日
                        <input type="date"th:field="*{userInfo.birthDate}"required>
                    </label>
                    <label>
                        本籍
                        <input type="text" th:field="*{userInfo.permanentAddress}" placeholder="">
                    </label>
                    <label>
                        配偶者
                        <select th:field="*{userInfo.spouse}">
                            <option value="false">無</option>
                            <option value="true">有</option>
                        </select>
                    </label>
                </div>
                <div class="input-group">
                    <label>
                        現住所
                        <input type="text" th:field="*{userInfo.currentAddress}" placeholder="">
                    </label>
                    <label>
                        最寄り駅
                        <input type="text" th:field="*{userInfo.nearestStation}" placeholder="">
                    </label>
                </div>
            </section>

            <!-- Education Section -->
            <section class="education">
                <h2>学歴</h2>
                <div class="input-group">
                    <label>
                        区分
                        <select th:field="*{userInfo.lastSchoolType}">
                            <option value="4年制">4年制</option>
                            <option value="2年制">2年制</option>
                        </select>
                    </label>
                    <label>
                        学校名
                        <input type="text" th:field="*{userInfo.lastSchool}" placeholder="">
                    </label>
                    <label>
                        卒業年月
                        <input type="date" th:field="*{userInfo.graduationDate}"required>
                    </label>
                    <label>
                        専攻名
                        <input type="text" th:field="*{userInfo.major}" placeholder="">
                    </label>
                </div>
            </section>

            <!-- Experience Sections -->
            <section class="experience">
                <h2>経歴</h2>
                <div id="experience-sections">
                    <section class="experience-item">
                        <h3>プロジェクト <span>1</span></h3>
                        <div class="input-group">
                            <label>
                                プロジェクト名
                                <input type="text" th:field="*{projects[0].projectName}" placeholder="">
                            </label>
                            <label>
                                作業場所
                                <input type="text" th:field="*{projects[0].location}" placeholder="">
                            </label>
                            <label>
                                開始日
                                <input type="date" th:field="*{projects[0].startDate}"required>
                            </label>
                            <label>
                                終了日
                                <input type="date" th:field="*{projects[0].endDate}"required>
                            </label>
                        </div>
                        <div class="input-group">
                            <label>
                                担当したプロセス 
                                <div class="process-chips" id="process-chips-0">
                                    <span class="process-chip">調査分析</span>
                                    <span class="process-chip">設計</span>
                                    <span class="process-chip">開発</span>
                                    <span class="process-chip">テスト</span>
                                    <span class="process-chip">運用保守</span>
                                </div>
                                <input type="hidden" name="projects[0].processes" id="projects[0].processes">
                            </label>
                        </div>
                        <!-- Skill -->
                        <div class="input-group tech">
                            <label class="skill-label">
                                OS
                                <div class="selected-skills-list" id="selected-skills-0-os"></div>
                                <input type="hidden" name="projects[0].os" id="projects[0].os">
                            </label>
                            <label class="skill-label">
                                DB
                                <div class="selected-skills-list" id="selected-skills-0-db"></div>
                                <input type="hidden" name="projects[0].db" id="projects[0].db">
                            </label>
                            <label class="skill-label">
                                Language
                                <div class="selected-skills-list" id="selected-skills-0-language"></div>
                                <input type="hidden" name="projects[0].language" id="projects[0].language">
                            </label>
                            <label class="skill-label">
                                Tools
                                <div class="selected-skills-list" id="selected-skills-0-tool"></div>
                                <input type="hidden" name="projects[0].tool" id="projects[0].tool">
                            </label>
                            <button type="button" class="skill-add-button" onclick="openSkillPopup(0)">スキル追加</button>
                        </div>
                        <div class="responsibility">
                            <textarea th:field="*{projects[0].responsibility}" placeholder="担当した業務を簡単に記入してください。"
                                maxlength="500" style="overflow: hidden; resize: none;"></textarea>
                        </div>
                    </section>  
                </div>
                <button type="button" class="history-add-button">経歴追加</button>
            </section>

            <!-- Summary Section -->
            <section class="summary">
                <h2>自己PR</h2>
                <div class="input-group">
                    <label>
                        自己PR
                        <textarea th:field="*{userInfo.selfPr}" placeholder="簡単に自己PRしてください。"
                            style="overflow: hidden; resize: none;"></textarea>
                    </label>
                </div>
            </section>
        </form>

        <!-- Skill Popup Modal -->
        <div id="skill-popup" class="modal">
            <div class="modal-content">
                <span class="close-button" onclick="closeSkillPopup()">&times;</span>
                <h2>スキル追加</h2>
                <div class="skill-category">
                    <h3>Language</h3>
                    <div class="skill-chips" data-category="language" id="language-skills-popup">
                        <span class="skill-chip" data-category="language">JavaScript</span>
                        <span class="skill-chip" data-category="language">Python</span>
                        <span class="skill-chip" data-category="language">Java</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>DB</h3>
                    <div class="skill-chips" data-category="db" id="db-skills-popup">
                        <span class="skill-chip" data-category="db">MySQL</span>
                        <span class="skill-chip" data-category="db">PostgreSQL</span>
                        <span class="skill-chip" data-category="db">MongoDB</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>OS</h3>
                    <div class="skill-chips" data-category="os" id="os-skills-popup">
                        <span class="skill-chip" data-category="os">Linux</span>
                        <span class="skill-chip" data-category="os">Windows</span>
                        <span class="skill-chip" data-category="os">macOS</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>Tools</h3>
                    <div class="skill-chips" data-category="tool" id="tool-skills-popup">
                        <span class="skill-chip" data-category="tool">Docker</span>
                        <span class="skill-chip" data-category="tool">Kubernetes</span>
                        <span class="skill-chip" data-category="tool">Git</span>
                    </div>
                </div>
                <button type="button" class="apply-button">適用</button>
            </div>
        </div>

    </div>
</body>

</html>